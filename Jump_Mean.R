#===============================================================================
# Takes the mean of each 'jump' sections and returns new vector
#===============================================================================
Jump_Mean <- function(vector,
                      jump = 3,
                      end = NA,
                      na.rm = TRUE,
                      anchor = FALSE)
{
  #-------------------------------------------------------------------------------
  # Vector error
  if(is.vector(vector) == FALSE){
    stop('\nJump_Mean: DATA NOT IN FORM OF VECTOR')
  } else {}
  #-------------------------------------------------------------------------------
  
  #-------------------------------------------------------------------------------
  # Numeric error
  if(is.numeric(vector) == FALSE){
    stop('\nJump_Mean: DATA NOT IN FORM OF NUMERIC')
  } else {}
  #-------------------------------------------------------------------------------

  #-------------------------------------------------------------------------------
  # length error
  if(jump >= length(vector)){
    stop('\nJump_Mean: JUMP >= LENGTH OF VECTOR')
  } else {}
  #-------------------------------------------------------------------------------
  
  #-------------------------------------------------------------------------------
  # length error
  if(jump < 3){
    stop('\nJump_Mean: JUMP < 3 (MINIMUM VALUE)')
  } else {}
  #-------------------------------------------------------------------------------
  
  #-------------------------------------------------------------------------------
  jump <- jump - 1 # corrects jump so that the total values are jump length long
  #-------------------------------------------------------------------------------
  
  #-------------------------------------------------------------------------------
  # Setting up the values and lengths
  vector <- as.vector(unlist(vector)) # enforcing vector if data frame column
  #-------------------------------------------------------------------------------

  #-------------------------------------------------------------------------------
  # Setting up anchor
  if(anchor == TRUE){
    anchor_value <- 0
  } else {
    anchor_value <- 1
  }
  #-------------------------------------------------------------------------------

  #-------------------------------------------------------------------------------
  # Setting up jump sequence
  sequence <- seq(from = 1, to = length(vector), by = jump) %>%
    append(values = length(vector))
  #-------------------------------------------------------------------------------
  
  #-------------------------------------------------------------------------------
  if(is.na(end) == TRUE){
    new_vector <- Jump_To_NA(vector, sequence, anchor_value, na.rm, jump)
  } else {
    new_vector <- Jump_To_End(vector, sequence, anchor_value, na.rm)
  }
  #-------------------------------------------------------------------------------
  return(new_vector)
}
#-------------------------------------------------------------------------------





#===============================================================================
# If mean is jump end
#===============================================================================
Jump_To_End <- function(vector, sequence, anchor_value, na.rm)
{
  #-------------------------------------------------------------------------------
  new_vector <- c()
  reached_end <- FALSE
  for(i in 1:length(sequence)){
    pos1 <- (sequence[i]+(anchor_value*(i-1)))
    pos2 <- (sequence[i + 1]+(anchor_value*(i-1)))
    #-------------------------------------------------------------------------------
    if(i < length(sequence) &
       reached_end == FALSE){
      #-------------------------------------------------------------------------------
      if(pos2 >= tail(sequence,1)){
        pos2 <- tail(sequence,1)
        reached_end <- TRUE
      }
      #-------------------------------------------------------------------------------
      
      #-------------------------------------------------------------------------------
      if(i == 1){
        mean <- mean(vector[pos1:pos2], na.rm = na.rm)
        if(is.nan(mean) == TRUE){
          mean <- NA
        }
      }
      #-------------------------------------------------------------------------------
      
      #-------------------------------------------------------------------------------
      if(i > 1){
        mean <- mean(vector[pos1:pos2],
                     na.rm = na.rm)
        if(is.nan(mean) == TRUE){
          mean <- NA
        }
      }
      #-------------------------------------------------------------------------------
      new_vector <- append(new_vector, mean)
    }
    #-------------------------------------------------------------------------------
  }
  #-------------------------------------------------------------------------------
  return(new_vector)
}
#-------------------------------------------------------------------------------




#===============================================================================
# If mean is jump NA
#===============================================================================
Jump_To_NA <- function(vector, sequence, anchor_value, na.rm, jump)
{
  #-------------------------------------------------------------------------------
  new_vector <- c()
  reached_end <- FALSE
  for(i in 1:length(sequence)){
    #-------------------------------------------------------------------------------
    pos1 <- (sequence[i]+(anchor_value*(i-1)))
    pos2 <- (sequence[i + 1]+(anchor_value*(i-1)))
    if(i < length(sequence) &
       reached_end == FALSE){
      #-------------------------------------------------------------------------------
      if(pos2 >= tail(sequence,1)){
        pos2 <- tail(sequence,1)
        reached_end <- TRUE
      }
      #-------------------------------------------------------------------------------
      
      #-------------------------------------------------------------------------------
      if(i == 1){
        mean <- mean(vector[pos1:pos2], na.rm = na.rm)
        #-------------------------------------------------------------------------------
        if(is.nan(mean) == TRUE){
          mean <- NA
        }
        #-------------------------------------------------------------------------------
      }
      #-------------------------------------------------------------------------------
      
      #-------------------------------------------------------------------------------
      if(i > 1){
        #-------------------------------------------------------------------------------
        if((pos2 - pos1) < jump){
          mean <- NA
        } else {
          mean <- mean(vector[pos1:pos2],
                       na.rm = na.rm)
          #-------------------------------------------------------------------------------
          if(is.nan(mean) == TRUE){
            mean <- NA
          }
          #-------------------------------------------------------------------------------
        }
        #-------------------------------------------------------------------------------
      }
      #-------------------------------------------------------------------------------
      new_vector <- append(new_vector, mean)
    }
    #-------------------------------------------------------------------------------
  }
  #-------------------------------------------------------------------------------
  return(new_vector)
}
#-------------------------------------------------------------------------------
